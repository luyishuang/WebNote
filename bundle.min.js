function MenuBar(){this.menus=[],this.active=-1,this.show=function(t){for(var e=$('<div class="notepad-menubar"></div>'),n=$('<ul class="menu-title">'),l=0;l<t.length;l++){var s=$("<li class='title'>"+t[l].title+"</li>");s.click(this.pullMenu.bind(this,l)),s.mouseover(this.pullMenu.bind(this,l)),n.append(s)}e.append(n);for(l=0;l<t.length;l++){for(var i=$('<ul class="menus"></ul>'),o=t[l].menuItems,a=0;a<o.length;a++){if("hr"==o[a].title){var c=$('<li class="menu-hr"></li>');i.append(c)}else{var d=$("<li class='menu-item'>"+t[l].menuItems[a].title+"<span class='shortcut'>"+t[l].menuItems[a].shortcut+"</span></li>");d.click(o[a].handler)}i.append(d)}i.css("width",t[l].width),i.css("left",54*l),e.append(i),this.menus.push(i)}return this.$bar=e},this.hideMenu=function(){this.active=-1;for(var t=0;t<this.menus.length;t++)this.menus[t].removeClass("active")},this.pullMenu=function(t,e){if(e.stopPropagation(),"click"==e.type&&-1<this.active)this.hideMenu();else if("click"==e.type||-1<this.active){this.active=t;for(var n=0;n<this.menus.length;n++)n==t?this.menus[n].addClass("active"):this.menus[n].removeClass("active")}}}function Editor(){this.$editor=$('<div class="notepad-editor"></div>'),this.$textarea=$('<textarea spellcheck="false" auto-size="none" wrap="off"></textarea>'),this.show=function(){return this.$editor.append(this.$textarea),this.$editor}}function DlgFont(t){this.$editor=t,this.$textarea=t.$textarea,this.fonts=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],this.styles=["常规","斜体","粗体","粗偏斜体"],this.sizes=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],this.$selectBoxInput=[],this.$selectBoxList=[[],[],[]],this.$sample_txt=$('<p class="sample-txt">AaBbYyZz</p>'),this.nowFont=[0,0,0],this.newFont=[0,0,0],this.show=function(){var t=$('<div class="notepad-dlg-mask notepad-dlg-font"></div>'),o=$('<div class="dialogbox notepad-dlgbox"></div>'),e=$('<div class="notepad-dlg-titlebar"></div>'),n=$('<div class="zititle">字体</div>'),l=$('<div class="close-btn" title="关闭">✖</div>'),s=$('<div class="main notepad-dlg-main"></div>'),i=$('<div class="notepad-dlg-select"></div>'),a=$('<fieldset class="sample"></fieldset>'),c=$('<div class="script"></div>'),d=$("<select></select>"),h=$('<input class="btn-ok" type="button" value="确定">'),u=$('<input class="btn-cancel" type="button" value="取消">'),r=this.$sample_txt,p=[{title:"字体(F):",list:this.fonts,value:2},{title:"字形(Y):",list:this.styles,value:0},{title:"大小(S):",list:this.sizes,value:6}];a.append($("<legend>示例</legend>")),a.append(r),c.append($("<span>脚本(R):</span><br>")),d.append($('<option value="西欧语言">西欧语言</option>')),d.append($('<option value="中文 GB2312">中文 GB2312</option>')),c.append(d),s.append(i),s.append(a),s.append(c),s.append(h),s.append(u),e.mousedown(function(l){var s=o.position().top,i=o.position().left;0==l.button&&(t.mousemove(function(t){var e=t.pageX-l.pageX+i+"px",n=t.pageY-l.pageY+s+"px";o.css("left",e),o.css("top",n)}),t.mouseup(function(){t.off("mousemove"),t.off("mouseup")}))}),o.append(e),l.click(this.closefontbox.bind(this)),e.append(n),e.append(l);for(var f=0;f<p.length;f++){for(var m=$("<span>"+p[f].title+"</span>"),g=$("<input class='zibox' type='text'>"),b=$("<ul class='ullist'></ul>"),v=0;v<p[f].list.length;v++){var x=p[f].list[v],k=$("<li class='list'>"+x+"</li>");0==f?k.css("font-family",x):1==f&&this.changeZi(k,v),k.click(this.selectLi.bind(this,f,v)),this.$selectBoxList[f].push(k),b.append(k)}this.$selectBoxInput.push(g),this.selectLi(f,p[f].value),i.append(m),i.append(g),i.append(b)}return this.ok(),h.click(function(){this.ok(),this.closefontbox()}.bind(this)),u.click(this.closefontbox.bind(this)),o.append(s),t.append(o),this.$notepad_dlg_font=t},this.openfontbox=function(){this.$notepad_dlg_font.addClass("show")},this.closefontbox=function(){this.$notepad_dlg_font.removeClass("show")},this.ok=function(){this.nowFont=this.newFont,this.$textarea.css("font-family",this.fonts[this.newFont[0]]),this.changeZi(this.$textarea,this.newFont[1]),this.$textarea.css("font-size",this.sizes[this.newFont[2]]+"px")},this.changeZi=function(t,e){0==e?(t.css("font-style","normal"),t.css("font-weight","normal")):1==e?(t.css("font-style","italic"),t.css("font-weight","normal")):2==e?(t.css("font-style","normal"),t.css("font-weight","bold")):3==e&&(t.css("font-style","italic"),t.css("font-weight","bold"))},this.selectLi=function(t,e){for(var n=0;n<this.$selectBoxList[t].length;n++)n==e?this.$selectBoxList[t][n].addClass("selected"):this.$selectBoxList[t][n].removeClass("selected");this.newFont[t]=e,0==t?(this.$selectBoxInput[t].val(this.fonts[e]),this.$sample_txt.css("font-family",this.fonts[e])):1==t?(this.$selectBoxInput[t].val(this.styles[e]),this.changeZi(this.$sample_txt,e)):2==t&&(this.$selectBoxInput[t].val(this.sizes[e]),this.$sample_txt.css("font-size",this.sizes[e]+"px"))}}var $app=$("#notepad-app"),menubar=new MenuBar,editor=new Editor,$editor=editor.show();$app.append($editor);var dlgFont=new DlgFont(editor),$dlgFont=dlgFont.show();$app.append($dlgFont),$app.click(menubar.hideMenu.bind(menubar));var menuData=[{title:"文件(F)",menuItems:[{title:"新建(N)",shortcut:"Ctrl+N",enabled:!0,handler:function(){console.log("新建(N) menu clicked!")}},{title:"打开(O)...",shortcut:"Ctrl+O",enabled:!0,handler:function(){console.log("打开(O) menu clicked!")}},{title:"保存(S)",shortcut:"Ctrl+S",enabled:!0,handler:function(){console.log("保存(S) menu clicked!")}},{title:"另存为(A)...",shortcut:"",enabled:!0,handler:function(){console.log("另存为(A) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"页面设置(U)...",shortcut:"",enabled:!0,handler:function(){console.log("页面设置(U) menu clicked!")}},{title:"打印(P)...",shortcut:"Ctrl+P",enabled:!0,handler:function(){console.log("打印(P) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"退出(X)",shortcut:"",enabled:!0,handler:function(){console.log("退出(X) menu clicked!")}}],width:"202px",left:"0px"},{title:"编辑(E)",menuItems:[{title:"撤销(U)",shortcut:"Ctrl+Z",enabled:!1,handler:function(){console.log("撤销(U) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"剪切(T)",shortcut:"Ctrl+X",enabled:!0,handler:function(){console.log("剪切(X) menu clicked!")}},{title:"复制(C)",shortcut:"Ctrl+C",enabled:!1,handler:function(){console.log("复制(C) menu clicked!")}},{title:"粘贴(P)",shortcut:"Ctrl+V",enabled:!1,handler:function(){console.log("粘贴(P) menu clicked!")}},{title:"删除(L)",shortcut:"Del",enabled:!1,handler:function(){console.log("删除(L) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"使用 Bing 搜索...",shortcut:"Ctrl+E",enabled:!0,handler:function(){console.log("使用 Bing 搜索 menu clicked!")}},{title:"查找(F)...",shortcut:"Ctrl+F",enabled:!1,handler:function(){console.log("查找(F) menu clicked!")}},{title:"查找下一个(N)",shortcut:"F3",enabled:!1,handler:function(){console.log("查找下一个(N) menu clicked!")}},{title:"替换(R)...",shortcut:"Ctrl+H",enabled:!0,handler:function(){console.log("替换(R) menu clicked!")}},{title:"转到(G)...",shortcut:"Ctrl+G",enabled:!0,handler:function(){console.log("转到(G) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"全选(A)",shortcut:"Ctrl+A",enabled:!0,handler:function(){console.log("全选(A) menu clicked!")}},{title:"时间/日期(D)",shortcut:"F5",enabled:!0,handler:function(){console.log("时间/日期(D) menu clicked!")}}],width:"218px",left:"52px"},{title:"格式(O)",menuItems:[{title:"自动换行(W)",shortcut:"",enabled:!0,handler:function(){console.log("自动换行(W) menu clicked!")}},{title:"字体(F)...",shortcut:"",enabled:!0,handler:dlgFont.openfontbox.bind(dlgFont)}],width:"156px",left:"106px"},{title:"查看(V)",menuItems:[{title:"状态栏(S)",shortcut:"",enabled:!0,handler:function(){console.log("状态栏(S) menu clicked!")}}],width:"138px",left:"162px"},{title:"帮助(H)",menuItems:[{title:"查看帮助(H)",shortcut:"",enabled:!0,handler:function(){window.open("https://cn.bing.com/search?q=获取有关+windows+10+中的记事本的帮助","_blank")}},{title:"关于记事本(A)",shortcut:"",enabled:!0,handler:function(){console.log("关于记事本(A) menu clicked!")}}],width:"166px",left:"216px"}],$menubar=menubar.show(menuData);$app.append($menubar);